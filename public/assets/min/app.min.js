"use strict";!function(){angular.module("Core",[]).config(["$interpolateProvider",function(t){t.startSymbol("{["),t.endSymbol("]}")}])}(),function(){function t(){return function(t,o,r){if(o&&(t=parseFloat(t)+parseFloat(o),r&&(t/=1e3)),0==t)return"0 đ";if(t){t=t.toString().split("").reverse();for(var n="",e=1;e<=t.length;e++)n+=e%3==0&&0!=e?t[e-1]+".":t[e-1];var i=n.split("").reverse();return"."==i[0]&&i.splice(0,1),r?i.join("").toString():i.join("")+" đ"}}}angular.module("Core").filter("vndCurrency",t)}(),function(){angular.module("Home",[]).config(["$interpolateProvider",function(t){t.startSymbol("{["),t.endSymbol("]}")}])}(),function(){function t(t,o,r,n){var e=this;e.orderCount=1,e.loadPage=function(){t.productList().then(function(t){200==t.status&&(e.productList=t.data)})},e.detailProduct=function(o){t.detailProduct({slug:o}).then(function(t){200==t.status&&(e.productDetail=t.data,e.productDetail.description=n.trustAsHtml(e.productDetail.description),e.productDetail.intro=n.trustAsHtml(e.productDetail.intro))})},e.changeOrderCount=function(t){t?e.orderCount++:e.orderCount--,e.orderCount=e.orderCount<1?1:e.orderCount,e.orderCount=e.orderCount>5?5:e.orderCount},e.order={},e.openOrder=function(){var t=e.productDetail.title,o=e.productDetail.price*e.orderCount;t&&o&&(e.order={product_name:t,product_price:o},$.magnificPopup.open({items:{src:"#order-form"},fixedContentPos:!0}))},e.confirmOrder=function(r){if(e.submitted=!0,!r||!e.order.user_address)return void o.error("Thông tin đặt hàng chưa hợp lệ!","Lỗi!");e.submitting=!0,t.orderProduct({product_name:e.order.product_name,product_count:e.orderCount,product_price:e.order.product_price,user_name:e.order.user_name,user_address:e.order.user_address,user_email:e.order.user_email,user_phone:e.order.user_phone,user_note:e.order.user_note}).then(function(t){200==t.status&&t.data?(o.success("Đặt hàng thành công, đơn hàng đang được xử lý","Thành công!"),$.magnificPopup.close()):o.error("Có lỗi xảy ra, liên hệ 01262346655 để được hỗ trợ!","Lỗi!"),e.submitted=!1,e.submitting=!1}).catch(function(){o.error("Có lỗi xảy ra, liên hệ 01262346655 để được hỗ trợ!","Lỗi!"),e.submitted=!1,e.submitting=!1})}}t.$inject=["ProductSvc","toastr","$http","$sce"],angular.module("Home").controller("HomeController",t)}(),function(){angular.module("Product",[]).config(["$interpolateProvider",function(t){t.startSymbol("{["),t.endSymbol("]}")}])}(),function(){function t(t,o){var r=this;r.tinymceOptions={plugins:"link image code",toolbar:"undo redo | fontselect fontsizeselect bold italic | alignleft aligncenter alignright | code",menubar:!1},r.createProduct=function(n){if(!n)return void o.error("Kiểm tra dữ liệu form");t.createProduct({title:r.form.title,price:r.form.price,description:r.form.description,slug:r.form.slug,imageLink:r.form.imageLink,bannerLink:r.form.bannerLink,intro:r.form.intro}).then(function(t){200==t.status?o.success("Thêm sản phẩm thành công"):o.error("Xảy ra lỗi")}).catch(function(t){o.error("Xảy ra lỗi")})},r.changeTitle=function(t){r.form.slug=slug(t).toLowerCase()},r.getListProduct=function(){t.productList().then(function(t){200==t.status&&(r.productList=t.data)})},r.deleteProduct=function(n,e){confirm("Bạn có chắc chắn muốn xóa sản phẩm này?")&&t.deleteProduct({product_id:n}).then(function(t){200==t.status&&t.data?(o.success("Đã xóa sản phẩm thành công!"),r.productList.splice(e,1)):o.error("Có lỗi xảy ra!")})}}t.$inject=["ProductSvc","toastr"],angular.module("Product").controller("PortalProductController",t)}(),function(){function t(t){return{productList:function(){return t.get(apiPath+"/api/product/productList")},createProduct:function(o){return t.post(apiPath+"/api/product/createProduct",o)},detailProduct:function(o){return t.post(apiPath+"/api/product/detailProduct",o)},orderProduct:function(o){return t.post(apiPath+"/api/product/order",o)},deleteProduct:function(o){return t.post(apiPath+"/api/product/deleteProduct",o)}}}t.$inject=["$http"],angular.module("Product").service("ProductSvc",t)}(),function(){angular.module("User",[]).config(["$interpolateProvider",function(t){t.startSymbol("{["),t.endSymbol("]}")}])}(),function(){function t(t,o,r,n,e){var i=this;i.accountInfo={},i.getAccount=function(){t.account().then(function(t){200==t.status&&(i.accountInfo=t.data,t.data.roles.indexOf("admin")>-1&&(i.accountInfo.isAdmin=!0))})},i.getAccount(),i.login=function(){t.login({email:i.form.email,password:i.form.password}).then(function(t){console.log("Resp",t),o.put("token",t.data.token,{path:"/"}),window.location.reload()})},i.logout=function(){t.logout().then(function(t){o.remove("token"),window.location.reload()}).catch(function(t){o.remove("token"),window.location.reload()})},i.register=function(){t.register({email:i.form.email,password:i.form.password}).then(function(t){console.log("Resp",t),n.success("Đăng ký tài khoản thành công!","Thông báo!"),e(i.login,2e3)}).catch(function(t){var o=t.data;n.error(o.message||o,"Thông báo!")})}}t.$inject=["UserService","$cookies","$rootScope","toastr","$timeout"],angular.module("User").controller("UserController",t)}(),function(){function t(t){var o;return{login:function(o){return t({method:"POST",url:apiPath+"/api/user/login",data:o})},logout:function(o){return t({method:"GET",url:apiPath+"/api/user/logout"})},account:function(r){return o||(o=t({method:"GET",url:apiPath+"/api/user/account"})),o},register:function(o){return t({method:"POST",url:apiPath+"/api/user/register",data:o})}}}t.$inject=["$http"],angular.module("User").service("UserService",t)}();var apiPath=window.location.origin;window.location.port&&(apiPath=window.settings.services.apiUrl),function(){var t=["Core","User","ngCookies","ngAnimate","toastr","angular-loading-bar","ui.tinymce","Product","Home"];angular.module("HapiApp",t).config(["$httpProvider",function(t){t.defaults.withCredentials=!0}])}();